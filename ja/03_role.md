# 3. コードレビューの役割分担

## 3.1 静的コード解析やツールでチェックできる項目（自動化推奨）

- コーディング規約・フォーマット（Pint / phpcs）
- Lint チェック（PHPStan / Larastan / ESLint）
- 型チェック（PHPStan / TypeScript）
- デッドコード検出
- SQL インジェクションや XSS などの基本的なセキュリティチェック（Psalm / Snyk / SonarQube）
- N+1 問題の検出（Telescope / Debugbar）
- テストカバレッジ測定（PHPUnit / Jest）
- 依存ライブラリの脆弱性検知（`composer audit` / Snyk）

## 3.2 AI や支援ツールが補助できる領域（今後の拡張）

- Diff ベースの設計ミス・改善提案（AI コードレビューボット）
- PR 説明文の生成支援（LLM 活用）
- 影響範囲の自動解析・可視化支援（AI ＋ Call Graph）
- 過去のレビュー履歴や知見をもとにしたアドバイス提案

## 3.3 人が担当すべき項目（重点確認領域）

- 仕様・設計の正しさ
- ビジネスロジックの妥当性
- 設計意図や責務分離の妥当性
- 将来的な仕様変更・拡張への耐性
- 影響範囲の深掘り（特にレガシー干渉）
- PR 説明・背景・意図の確認
- UX・UI 設計（フロントエンドの場合）

## 3.4 各観点ごとの担当分類表

| カテゴリ                        | 観点・項目                         | ツール                     | 人力 | AI 補助            |
| ------------------------------- | ---------------------------------- | -------------------------- | ---- | ------------------ |
| 機能・仕様の正しさ              | 仕様通りの動き・要件実現           |                            | ◎    | △                  |
| 機能・仕様の正しさ              | 境界値・例外ケース考慮             |                            | ◎    | △                  |
| 可読性・保守性                  | 命名規則チェック                   | ◎（PHPStan / Lint）        | △    | △                  |
| 可読性・保守性                  | コメントの適切さ                   |                            | ◎    | △                  |
| 可読性・保守性                  | ネスト・分割の適切さ               |                            | ◎    | △                  |
| 可読性・保守性                  | 重複・DRY チェック                 | ◎（PHPStan）               | △    | △                  |
| パフォーマンス                  | 無駄なループ・重い処理             | ◎（PHPStan）               | △    | △                  |
| パフォーマンス                  | DB アクセス最適化                  | ◎（Larastan）              | △    | △                  |
| パフォーマンス（Laravel）       | N+1 問題                           | ◎（Telescope / Debugbar）  | △    | △                  |
| セキュリティ                    | 入力バリデーション適切さ           | ◎（Psalm / PHPStan）       | △    | △                  |
| セキュリティ                    | SQL インジェクション対策           | ◎（Psalm / Snyk）          | △    | △                  |
| セキュリティ                    | XSS、CSRF 対策                     | ◎（SonarQube）             | △    | △                  |
| テスト観点                      | カバレッジ測定（量）               | ◎（PHPUnit Coverage）      |      |                    |
| テスト観点                      | テストケースの質・網羅性           |                            | ◎    | △                  |
| 設計・アーキテクチャ            | 責務分離・SRP 原則                 |                            | ◎    | △（Deptrac）       |
| 設計・アーキテクチャ            | 再利用性・拡張性                   |                            | ◎    | △                  |
| コーディング規約・スタイル      | フォーマット・規約                 | ◎（Pint / phpcs）          |      |                    |
| コーディング規約・スタイル      | 型チェック                         | ◎（PHPStan / TS）          |      |                    |
| コーディング規約・スタイル      | デッドコード検出                   | ◎（PHPStan / Psalm）       |      |                    |
| 依存関係                        | 脆弱ライブラリ検出                 | ◎（composer audit / Snyk） | △    |                    |
| 変更影響・拡張性                | 影響範囲特定・考慮                 |                            | ◎    | △（Call Graph）    |
| PR 説明・ドキュメント           | PR 説明・背景の明確さ              |                            | ◎    | △（生成支援）      |
| UI/UX（Angular）                | UI/UX 設計                         |                            | ◎    | △（ESLint / a11y） |
| UI/UX（Angular）                | RxJS 購読・メモリリーク防止        | ◎（ESLint）                | △    | △                  |
| 設計・アーキテクチャ（Angular） | Angular モジュール設計（LazyLoad） |                            | ◎    | △                  |
| フロントエンド実装（Angular）   | フォームバリデーション             |                            | ◎    | △                  |
| UI/UX（Angular）                | アクセシビリティ（a11y）           | ◎（a11y lint）             | △    | △                  |

### ◎・△ の意味（凡例）

| 記号 | 意味             | 説明                                                                                     |
| ---- | ---------------- | ---------------------------------------------------------------------------------------- |
| ◎    | 完全対応・主担当 | その担当（ツール / AI / 人力）が主要な役割としてチェックすべき。完全にカバーできる項目。 |
| △    | 補助・一部対応   | その担当が補助的・部分的に支援できる。ヒントやサポートは可能だが最終判断は人の目が必要。 |
